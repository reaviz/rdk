import{j as s}from"./jsx-runtime-9c4ae004.js";import{r as v}from"./index-1b03fe98.js";import{O as P,A as E}from"./OverlayContext-da5a27a1.js";import{O as R}from"./OverlayPortal-c2847cdb.js";import{u as j}from"./useExitListener-2fe55041.js";import{B as q}from"./Backdrop-22aa3ee2.js";let b=!1;if(typeof window<"u"){const e={get passive(){b=!0}};window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}const h=typeof window<"u"&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||window.navigator.platform==="MacIntel"&&window.navigator.maxTouchPoints>1);let a=[],d=new Map,w=!1,x=-1,f,u,r,p;const O=e=>a.some(t=>!!(t.options.allowTouchMove&&t.options.allowTouchMove(e))),g=e=>{const t=e||window.event;return O(t.target)||t.touches.length>1?!0:(t.preventDefault&&t.preventDefault(),!1)},_=e=>{if(p===void 0){const t=!!e&&e.reserveScrollBarGap===!0,i=window.innerWidth-document.documentElement.getBoundingClientRect().width;if(t&&i>0){const o=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right"),10);p=document.body.style.paddingRight,document.body.style.paddingRight=`${o+i}px`}}f===void 0&&(f=document.body.style.overflow,document.body.style.overflow="hidden")},A=()=>{p!==void 0&&(document.body.style.paddingRight=p,p=void 0),f!==void 0&&(document.body.style.overflow=f,f=void 0)},G=()=>window.requestAnimationFrame(()=>{const e=document.documentElement,t=document.body;if(r===void 0){u={...e.style},r={...t.style};const{scrollY:i,scrollX:o,innerHeight:m}=window;e.style.height="100%",e.style.overflow="hidden",t.style.position="fixed",t.style.top=`${-i}px`,t.style.left=`${-o}px`,t.style.width="100%",t.style.height="auto",t.style.overflow="hidden",setTimeout(()=>window.requestAnimationFrame(()=>{const c=m-window.innerHeight;c&&i>=m&&(t.style.top=-(i+c)+"px")}),300)}}),I=()=>{if(r!==void 0){const e=-parseInt(document.body.style.top,10),t=-parseInt(document.body.style.left,10),i=document.documentElement,o=document.body;i.style.height=(u==null?void 0:u.height)||"",i.style.overflow=(u==null?void 0:u.overflow)||"",o.style.position=r.position||"",o.style.top=r.top||"",o.style.left=r.left||"",o.style.width=r.width||"",o.style.height=r.height||"",o.style.overflow=r.overflow||"",window.scrollTo(t,e),r=void 0}},L=e=>e?e.scrollHeight-e.scrollTop<=e.clientHeight:!1,V=(e,t)=>{const i=e.targetTouches[0].clientY-x;return O(e.target)?!1:t&&t.scrollTop===0&&i>0||L(t)&&i<0?g(e):(e.stopPropagation(),!0)},$=(e,t)=>{if(!e){console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.");return}if(d.set(e,d!=null&&d.get(e)?(d==null?void 0:d.get(e))+1:1),a.some(o=>o.targetElement===e))return;const i={targetElement:e,options:t||{}};a=[...a,i],h?G():_(t),h&&(e.ontouchstart=o=>{o.targetTouches.length===1&&(x=o.targetTouches[0].clientY)},e.ontouchmove=o=>{o.targetTouches.length===1&&V(o,e)},w||(document.addEventListener("touchmove",g,b?{passive:!1}:void 0),w=!0))},T=()=>{h&&(a.forEach(e=>{e.targetElement.ontouchstart=null,e.targetElement.ontouchmove=null}),w&&(document.removeEventListener("touchmove",g,b?{passive:!1}:void 0),w=!1),x=-1),h?I():A(),a=[],d.clear()},k=({open:e,hasBackdrop:t=!0,closeOnEscape:i=!0,closeOnBackdropClick:o=!0,backdropClassName:m,children:c,onClose:l})=>{const y=v.useRef(null),S=v.useCallback(()=>{o&&(l==null||l())},[o,l]);return j({ref:y,open:e,onEscape:()=>i&&(l==null?void 0:l())}),v.useEffect(()=>(e&&y.current!==void 0?$(y.current,{allowTouchMove:n=>{for(;n&&n!==document.body;){if(n.getAttribute("body-scroll-lock-ignore")!==null)return!0;n.parentElement!==null&&(n=n.parentElement)}return!1}}):T(),()=>{T()}),[c,e]),s.jsx(P.Provider,{value:{close:()=>l==null?void 0:l()},children:s.jsx(E,{children:e&&s.jsx(R,{ref:y,children:({overlayIndex:n,portalIndex:B})=>s.jsxs(v.Fragment,{children:[t&&s.jsx(q,{zIndex:n,portalIndex:B,onClick:S,className:m}),s.jsx("div",{"body-scroll-lock-ignore":"true",children:c({overlayIndex:n,portalIndex:B})})]})})})})};try{k.displayName="GlobalOverlay",k.__docgenInfo={description:"",displayName:"GlobalOverlay",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},closeOnBackdropClick:{defaultValue:{value:"true"},description:"",name:"closeOnBackdropClick",required:!1,type:{name:"boolean"}},hasBackdrop:{defaultValue:{value:"true"},description:"",name:"hasBackdrop",required:!1,type:{name:"boolean"}},backdropClassName:{defaultValue:null,description:"",name:"backdropClassName",required:!1,type:{name:"string"}},closeOnEscape:{defaultValue:{value:"true"},description:"",name:"closeOnEscape",required:!1,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!1,type:{name:"(() => void)"}}}}}catch{}export{k as G};
